기본적으로 http는 5가지 구성요소를 가진다.

method,path,protocol version
http header
message body

get
조회만할 뿐 사이드 이팩이 없어야한다.
즉 idempotent(멱등성)을 유지해야한다.

path
상개경로이다.

protocol version
HTTP/1.1
TCP로 커낵션을 맺고 response를 전달받기 전까지 새로운 request를 보낼 수 없다.
그렇다고 커낵션을 요청을 보낼때마다 생성하는것은 아니다.
하나의 커낵션에서 요청에 대한 응답을 받기전 새로운 요청을 못보내는것일뿐

HTTP/2.0

header
키 벨류 문자열

클라이언트가 응답을 못받은 경우, is_retry를 같이 보낸다.

직렬화 3가지
json
쉽고 사람이 읽을 수 있다.
프로그래밍에 독립적이다
사람이 읽을 수 있으므로 자바나 다른 언어는 못읽는다
그래서 역직렬화를 위한 외부 라이브러리를 사용해야한다.
,나 {}나 등등 사람이 읽기 쉽게 바이너리로 직렬화되어있다.
직렬화된 구조를 그냥 다시 UTF-8로 디코딩하면 뭐라 써있는지 알 수 있다.

java 직렬화
자바에 최적화되어서 바이너리로 직렬화되어있다. 실제 바이너리로 인코딩된것을보면 사람이 읽을 수 없다.

구글 프로토 버퍼
다 언어를 지원한다. 이 또한 직렬화하면 사람이 읽을 수 없다. 

layer 4 load balancing
tcp 안의 초반 내용만 확인하고 자세한 내용은 파악하지않고 로드 밸런싱한다.

덕분에 코스트가 가장 적다.

메세지 브로커를 쓰는 이유
A->B->C->D->C->B->A로 api 요청응답을 받는 시간이 매우 길어진다. 타임아웃 발생 위험이 크다.
A와 B의 의존성을 느슨하게한다.
각자 따로 스케일 아웃이 가능하다.

